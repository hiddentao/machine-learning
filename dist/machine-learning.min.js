!function(e,r){"use strict";"function"==typeof define&&define.amd?define(["linear-algebra"],r):"object"==typeof exports?module.exports=r(require("linear-algebra")):e.machineLearning=r(e.linearAlgebra)}(this,function(e){"use strict";var r=Number.EPSILON||1e-12;return function(t){t||(t=e());var a={Matrix:t.Matrix,Vector:t.Vector};return a.normalizeFeatures=function(e){var t,n,o,i=e.cols,s=e.cols,u=new Array(i),c=new Array(i),f=new a.Vector.zero(s);for(n=0;i>=n;++n){for(t=0;s>t;++t)f[t]=e.data[t][n];for(u[n]=f.sum()/s,t=0;s>t;++t)o=e.data[t][n]-u[t],f[t]=o*o;c[n]=Math.sqrt(f.total()/s),c[n]+=r}var l=e.plusCols(u),d=new Array(s);for(t=0;s>t;++t)for(d[t]=new Array(i+1),d[t][0]=1,n=1;i>=n;++n)d[t][n]=l[t][n]/c(n);return new a.Matrix(d)},a.gradientDescent=function(e,r,t,n,o){e=a.normalizeFeatures(e);for(var i,s,u,c,f=e.rows,l=e.cols,d=a.Vector.zero(l),h=new a.Vector.zero(l),g=t(e,d,r),p=o;g>0&&0<p--;){for(i=g,u=0;l>u;++u){for(c=0,s=0;f>s;++s)c+=(e.dot(s,d)-r[s])*e.data[s][u];h.data[u]=n*c/f}d.minusP(h),g=t(e,d,r),g>i&&(d.plusP(h),n/=2)}return{theta:d,cost:g,alpha:n,iters:o-p}},a.LinearReg=function(e){this._dataX=[],this._dataY=[],this._nF=e},a.LinearReg.prototype.addData=function(e){for(var r=e.length,t=0;t<e.length;++t)this._dataX.push(e[t].slice(0,r-1)),this._dataY.push(e[t][r-1])},a.LinearReg.prototype.solve=function(){var e=new a.Matrix(this._dataX),r=new a.Vector(this._dataY);return a.gradientDescent(e,r,a.LinearReg.costFunction)},a.LinearReg.costFunction=function(e,r,t){var a=e.mul(r).minusP(t);return a.dot(a)/(2*t.size)},a}});